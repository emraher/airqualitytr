<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Turkish Air Quality Data Access Tools • airqualitytr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Turkish Air Quality Data Access Tools">
<meta name="description" content="Provides functions to download and explore air quality monitoring data from the Turkish Ministry of Environment, Urbanization and Climate Change. Enables researchers to access hourly and daily measurements of PM10, PM2.5, SO2, CO, NO2, NOX, NO, and O3 across monitoring stations throughout Turkey.">
<meta property="og:description" content="Provides functions to download and explore air quality monitoring data from the Turkish Ministry of Environment, Urbanization and Climate Change. Enables researchers to access hourly and daily measurements of PM10, PM2.5, SO2, CO, NO2, NOX, NO, and O3 across monitoring stations throughout Turkey.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">airqualitytr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/getting-started.html">Getting Started with airqualitytr</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emraher/airqualitytr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="airqualitytr">airqualitytr<a class="anchor" aria-label="anchor" href="#airqualitytr"></a>
</h1></div>
<!-- badges: start -->

<p><strong>airqualitytr</strong> is an R package that provides an interface to download and explore air quality data from the Turkish Ministry of Environment, Urbanization and Climate Change. It allows users to:</p>
<ul>
<li>Download time series air quality data for a specified station and parameters.</li>
<li>Retrieve the lists of available cities.</li>
<li>Retrieve station metadata.</li>
<li>Retrieve available measurement parameters.</li>
</ul>
<p>These functions enable researchers and analysts to quickly access and analyze environmental data in their R workflow.</p>
<p><strong>Note:</strong> This package was initially created by Emrah Er, with subsequent improvements made using <a href="https://claude.com/claude-code" class="external-link">Claude Code</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from GitHub using the <strong>pak</strong> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"emraher/airqualitytr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Load the package and explore the available options:</p>
<div class="section level3">
<h3 id="list-available-cities">List Available Cities<a class="anchor" aria-label="anchor" href="#list-available-cities"></a>
</h3>
<p>Retrieve a tibble of cities available for filtering:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emraher/airqualitytr" class="external-link">airqualitytr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="op">(</span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_cities.html">list_cities</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 81 × 2</span></span>
<span><span class="co">#&gt;    city_id                              city_name     </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                                &lt;chr&gt;         </span></span>
<span><span class="co">#&gt;  1 fddbbf7e-b853-431e-89d3-3522264e9383 Adana         </span></span>
<span><span class="co">#&gt;  2 50cd2278-5573-4069-b7a9-2aacaf11431a Adıyaman      </span></span>
<span><span class="co">#&gt;  3 c9b19ecd-1ffc-4616-ab1a-790aaf539bfe Afyonkarahisar</span></span>
<span><span class="co">#&gt;  4 12b12d2f-1fd1-41a5-9142-7fe31e5134e3 Ağrı          </span></span>
<span><span class="co">#&gt;  5 0d977726-b21e-4ef8-b852-e659286f1778 Aksaray       </span></span>
<span><span class="co">#&gt;  6 b1bd61cf-1528-4a3e-9b45-c30cbf223035 Amasya        </span></span>
<span><span class="co">#&gt;  7 8dbbe10c-b2c5-44c1-bb3e-90be45aee744 Ankara        </span></span>
<span><span class="co">#&gt;  8 c414e607-cb0f-4226-997c-62a9eb563b2b Antalya       </span></span>
<span><span class="co">#&gt;  9 d40a8bdb-1402-43e6-9e92-1f1c8484632c Ardahan       </span></span>
<span><span class="co">#&gt; 10 a0da922a-ff51-4e7d-9f75-7fe44217d725 Artvin        </span></span>
<span><span class="co">#&gt; # ℹ 71 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="list-available-stations">List Available Stations<a class="anchor" aria-label="anchor" href="#list-available-stations"></a>
</h3>
<p>Get metadata for all available stations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_stations.html">list_stations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stations</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 20</span></span>
<span><span class="co">#&gt;   station_id    station_name city_id city_name town_id location station_sub_type</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;               &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 468478b7-ace… Adana - Çat… fddbbf… Adana     f23102… POINT (…                1</span></span>
<span><span class="co">#&gt; 2 9a381f61-657… Adana - Çuk… fddbbf… Adana     f2c0da… POINT (…               23</span></span>
<span><span class="co">#&gt; 3 bdc1f3d0-004… Adana - Doğ… fddbbf… Adana     fb3596… POINT (…                1</span></span>
<span><span class="co">#&gt; 4 c31a108f-90b… Adana - Met… fddbbf… Adana     fb3596… POINT (…                1</span></span>
<span><span class="co">#&gt; 5 c75060c5-d28… Adana - Val… fddbbf… Adana     f2c0da… POINT (…                1</span></span>
<span><span class="co">#&gt; 6 2b79754a-c5f… Adana-Seyhan fddbbf… Adana     f2c0da… POINT (…               23</span></span>
<span><span class="co">#&gt; # ℹ 13 more variables: company_id &lt;chr&gt;, company_id_name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   station_group &lt;int&gt;, station_group_name &lt;chr&gt;, sector_code &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   sector_code_name &lt;chr&gt;, basin_id &lt;lgl&gt;, data_periods &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   source_type &lt;int&gt;, source_type_name &lt;chr&gt;, area_type &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   area_type_name &lt;chr&gt;, is_portable &lt;lgl&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="list-available-measurement-parameters">List Available Measurement Parameters<a class="anchor" aria-label="anchor" href="#list-available-measurement-parameters"></a>
</h3>
<p>Retrieve a tibble of available measurement parameters (e.g., PM10, CO, NO2):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_parameters.html">list_parameters</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span><span class="co">#&gt;   id    name  </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 PM10  PM10  </span></span>
<span><span class="co">#&gt; 2 PM25  PM 2.5</span></span>
<span><span class="co">#&gt; 3 SO2   SO2   </span></span>
<span><span class="co">#&gt; 4 CO    CO    </span></span>
<span><span class="co">#&gt; 5 NO2   NO2   </span></span>
<span><span class="co">#&gt; 6 NOX   NOX   </span></span>
<span><span class="co">#&gt; 7 NO    NO    </span></span>
<span><span class="co">#&gt; 8 O3    O3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-air-quality-data">Download Air Quality Data<a class="anchor" aria-label="anchor" href="#download-air-quality-data"></a>
</h3>
<p>Download time series air quality data for a specific station. You must provide the station’s unique identifier, select one or more measurement parameters, specify a date range, and choose the data frequency (hourly or daily).</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example inputs:</span></span>
<span><span class="va">station_id</span> <span class="op">&lt;-</span> <span class="st">"468478b7-ace5-4bd3-b89a-a9c1c2e53080"</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>, <span class="st">"CO"</span>, <span class="st">"NO2"</span><span class="op">)</span></span>
<span><span class="va">start_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-16 00:00"</span></span>
<span><span class="va">end_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-04-15 00:00"</span></span>
<span><span class="va">frequency</span> <span class="op">&lt;-</span> <span class="st">"hourly"</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_air_quality_data.html">download_air_quality_data</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="va">station_id</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>  start_datetime <span class="op">=</span> <span class="va">start_datetime</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="va">end_datetime</span>,</span>
<span>  frequency <span class="op">=</span> <span class="va">frequency</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 23</span></span>
<span><span class="co">#&gt;   time                station_id station_name city_id city_name town_id location</span></span>
<span><span class="co">#&gt;   &lt;dttm&gt;              &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 2025-03-16 00:00:00 468478b7-… Adana - Çat… fddbbf… Adana     f23102… POINT (…</span></span>
<span><span class="co">#&gt; 2 2025-03-16 00:00:00 468478b7-… Adana - Çat… fddbbf… Adana     f23102… POINT (…</span></span>
<span><span class="co">#&gt; 3 2025-03-16 00:00:00 468478b7-… Adana - Çat… fddbbf… Adana     f23102… POINT (…</span></span>
<span><span class="co">#&gt; 4 2025-03-16 01:00:00 468478b7-… Adana - Çat… fddbbf… Adana     f23102… POINT (…</span></span>
<span><span class="co">#&gt; 5 2025-03-16 01:00:00 468478b7-… Adana - Çat… fddbbf… Adana     f23102… POINT (…</span></span>
<span><span class="co">#&gt; 6 2025-03-16 01:00:00 468478b7-… Adana - Çat… fddbbf… Adana     f23102… POINT (…</span></span>
<span><span class="co">#&gt; # ℹ 16 more variables: station_sub_type &lt;int&gt;, company_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   company_id_name &lt;chr&gt;, station_group &lt;int&gt;, station_group_name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   sector_code &lt;int&gt;, sector_code_name &lt;chr&gt;, basin_id &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   data_periods &lt;int&gt;, source_type &lt;int&gt;, source_type_name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   area_type &lt;int&gt;, area_type_name &lt;chr&gt;, is_portable &lt;lgl&gt;, parameter &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   value &lt;dbl&gt;</span></span></code></pre></div>
<p>The resulting tibble contains:</p>
<ul>
<li>
<strong>time:</strong> POSIXct timestamp of the measurement.</li>
<li>
<strong>station_id:</strong> Station identifier from the API response.</li>
<li>
<strong>city_name:</strong> The city name provided.</li>
<li>
<strong>station_name:</strong> The station name provided.</li>
<li>
<strong>parameter:</strong> The measurement parameter (e.g., “PM10”).</li>
<li>
<strong>value:</strong> The corresponding measurement value.</li>
</ul>
</div>
<div class="section level3">
<h3 id="bulk-download">Bulk Download<a class="anchor" aria-label="anchor" href="#bulk-download"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the date range and parameters</span></span>
<span><span class="va">start_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-16 00:00"</span></span>
<span><span class="va">end_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-16 01:00"</span> <span class="co"># using a short interval for testing</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span></span>
<span><span class="va">frequency</span> <span class="op">&lt;-</span> <span class="st">"hourly"</span></span>
<span></span>
<span><span class="co"># Bulk download air quality data for all stations</span></span>
<span><span class="va">bulk_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>  start_datetime <span class="op">=</span> <span class="va">start_datetime</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="va">end_datetime</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>  frequency <span class="op">=</span> <span class="va">frequency</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect the combined data</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">bulk_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parallel-bulk-downloads">Parallel Bulk Downloads<a class="anchor" aria-label="anchor" href="#parallel-bulk-downloads"></a>
</h3>
<p>For faster bulk downloads, you can use parallel processing. This is especially useful when downloading data from many stations or large date ranges:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install parallel processing packages if not already installed</span></span>
<span><span class="co"># install.packages(c("future", "furrr", "progressr"))</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org" class="external-link">progressr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set up parallel processing with 4 workers</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bulk download with parallel processing</span></span>
<span><span class="va">start_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-16 00:00"</span></span>
<span><span class="va">end_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-16 01:00"</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>, <span class="st">"NO2"</span><span class="op">)</span></span>
<span><span class="va">frequency</span> <span class="op">&lt;-</span> <span class="st">"hourly"</span></span>
<span></span>
<span><span class="co"># Option 1: Let the function manage the parallel plan</span></span>
<span><span class="va">bulk_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>  start_datetime <span class="op">=</span> <span class="va">start_datetime</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="va">end_datetime</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>  frequency <span class="op">=</span> <span class="va">frequency</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span> <span class="co"># Number of parallel workers</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Option 2: Set up your own future plan</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">bulk_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>  start_datetime <span class="op">=</span> <span class="va">start_datetime</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="va">end_datetime</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>  frequency <span class="op">=</span> <span class="va">frequency</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Uses your existing plan</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span> <span class="co"># Reset to sequential processing</span></span>
<span></span>
<span><span class="co"># With progress tracking (requires progressr package)</span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/handlers.html" class="external-link">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Enable progress handlers</span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/handlers.html" class="external-link">handlers</a></span><span class="op">(</span><span class="st">"progress"</span><span class="op">)</span> <span class="co"># Use progress bar</span></span>
<span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">bulk_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>    start_datetime <span class="op">=</span> <span class="va">start_datetime</span>,</span>
<span>    end_datetime <span class="op">=</span> <span class="va">end_datetime</span>,</span>
<span>    parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>    frequency <span class="op">=</span> <span class="va">frequency</span>,</span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    workers <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">bulk_data</span><span class="op">)</span></span></code></pre></div>
<p>You can also use parallel processing for downloading all data from a single station:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">station_id</span> <span class="op">&lt;-</span> <span class="st">"468478b7-ace5-4bd3-b89a-a9c1c2e53080"</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>, <span class="st">"CO"</span>, <span class="st">"NO2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download all available data in parallel (parallelizes across time chunks)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_all_data_for_station.html">download_all_data_for_station</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="va">station_id</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"hourly"</span>,</span>
<span>  chunk_size <span class="op">=</span> <span class="st">"3 months"</span>, <span class="co"># Smaller chunks = more parallelization</span></span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bulk-download-2">Bulk Download 2<a class="anchor" aria-label="anchor" href="#bulk-download-2"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">station_id</span> <span class="op">&lt;-</span> <span class="st">"468478b7-ace5-4bd3-b89a-a9c1c2e53080"</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">name</span></span>
<span><span class="va">frequency</span> <span class="op">&lt;-</span> <span class="st">"hourly"</span></span>
<span></span>
<span><span class="co"># Download all available data for the specified station over the broad default range</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_all_data_for_station.html">download_all_data_for_station</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="va">station_id</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>  frequency <span class="op">=</span> <span class="va">frequency</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bulk-download-3---save-all-station-data-to-parquet-files">Bulk Download 3 - Save All Station Data to Parquet Files<a class="anchor" aria-label="anchor" href="#bulk-download-3---save-all-station-data-to-parquet-files"></a>
</h3>
<p>For very large bulk downloads, you can process each station sequentially or use parallel processing with <code>furrr</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/furrr" class="external-link">furrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emraher/airqualitytr" class="external-link">airqualitytr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the parameters to download.</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_parameters.html">list_parameters</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">name</span> <span class="co"># or simply: c("PM10", "CO", "NO2")</span></span>
<span></span>
<span><span class="co"># Retrieve station metadata from your package</span></span>
<span><span class="va">stations_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_stations.html">list_stations</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join city names (already included in list_stations() output)</span></span>
<span><span class="va">cities_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_cities.html">list_cities</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stations_meta</span> <span class="op">&lt;-</span> <span class="va">stations_meta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cities_meta</span>, by <span class="op">=</span> <span class="st">"city_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define frequency for downloading data.</span></span>
<span><span class="va">frequency</span> <span class="op">&lt;-</span> <span class="st">"hourly"</span> <span class="co"># or "daily"</span></span>
<span></span>
<span><span class="co"># Create an output folder to store Parquet files</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="st">"bulk_station_data"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"bulk_station_data"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Option 1: Sequential processing (original method)</span></span>
<span><span class="fu">pwalk</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    station_id <span class="op">=</span> <span class="va">stations_meta</span><span class="op">$</span><span class="va">station_id</span>,</span>
<span>    station_name <span class="op">=</span> <span class="va">stations_meta</span><span class="op">$</span><span class="va">station_name</span>,</span>
<span>    city_name <span class="op">=</span> <span class="va">stations_meta</span><span class="op">$</span><span class="va">city_name</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">station_id</span>, <span class="va">station_name</span>, <span class="va">city_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Downloading data for station: "</span>, <span class="va">station_name</span>, <span class="st">" ("</span>, <span class="va">station_id</span>, <span class="st">")"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Call download_all_data_for_station() with only the essential inputs.</span></span>
<span>    <span class="co"># This function automatically uses a broad date range (e.g. 1900-01-01 to 2099-12-31)</span></span>
<span>    <span class="co"># to fetch all available data for that station.</span></span>
<span>    <span class="va">station_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_all_data_for_station.html">download_all_data_for_station</a></span><span class="op">(</span></span>
<span>      station_id <span class="op">=</span> <span class="va">station_id</span>,</span>
<span>      parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>      frequency <span class="op">=</span> <span class="va">frequency</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Optionally, if station_data might be huge, you can periodically flush memory or</span></span>
<span>    <span class="co"># simply write the result directly.</span></span>
<span>    <span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"bulk_station_data"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"data_"</span>, <span class="va">station_id</span>, <span class="st">".parquet"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">arrow</span><span class="fu">::</span><span class="fu">write_parquet</span><span class="op">(</span><span class="va">station_data</span>, sink <span class="op">=</span> <span class="va">file_name</span>, compression <span class="op">=</span> <span class="st">"snappy"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Saved data to: "</span>, <span class="va">file_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Option 2: Parallel processing with furrr (much faster!)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://furrr.futureverse.org/reference/future_map2.html" class="external-link">future_pwalk</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    station_id <span class="op">=</span> <span class="va">stations_meta</span><span class="op">$</span><span class="va">station_id</span>,</span>
<span>    station_name <span class="op">=</span> <span class="va">stations_meta</span><span class="op">$</span><span class="va">station_name</span>,</span>
<span>    city_name <span class="op">=</span> <span class="va">stations_meta</span><span class="op">$</span><span class="va">city_name</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">station_id</span>, <span class="va">station_name</span>, <span class="va">city_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Download all available data with internal parallel processing for chunks</span></span>
<span>    <span class="va">station_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_all_data_for_station.html">download_all_data_for_station</a></span><span class="op">(</span></span>
<span>      station_id <span class="op">=</span> <span class="va">station_id</span>,</span>
<span>      parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>      frequency <span class="op">=</span> <span class="va">frequency</span>,</span>
<span>      parallel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Also parallelize time chunks</span></span>
<span>      show_progress <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># Disable messages in parallel</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Save to Parquet file</span></span>
<span>    <span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"bulk_station_data"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"data_"</span>, <span class="va">station_id</span>, <span class="st">".parquet"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">arrow</span><span class="fu">::</span><span class="fu">write_parquet</span><span class="op">(</span><span class="va">station_data</span>, sink <span class="op">=</span> <span class="va">file_name</span>, compression <span class="op">=</span> <span class="st">"snappy"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">file_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  .options <span class="op">=</span> <span class="fu"><a href="https://furrr.futureverse.org/reference/furrr_options.html" class="external-link">furrr_options</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span> <span class="co"># Reset to sequential processing</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="common-issues-and-solutions">Common Issues and Solutions<a class="anchor" aria-label="anchor" href="#common-issues-and-solutions"></a>
</h3>
<div class="section level4">
<h4 id="invalid-station_id-format">“Invalid station_id format”<a class="anchor" aria-label="anchor" href="#invalid-station_id-format"></a>
</h4>
<p><strong>Problem:</strong> Station ID is not in valid UUID format.</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get valid station IDs from list_stations()</span></span>
<span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_stations.html">list_stations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">valid_station_id</span> <span class="op">&lt;-</span> <span class="va">stations</span><span class="op">$</span><span class="va">station_id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Use this ID in your downloads</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_air_quality_data.html">download_air_quality_data</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="va">valid_station_id</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span>,</span>
<span>  start_datetime <span class="op">=</span> <span class="st">"2025-03-16 00:00"</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="st">"2025-03-17 00:00"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="start_datetime-must-be-before-end_datetime">“start_datetime must be before end_datetime”<a class="anchor" aria-label="anchor" href="#start_datetime-must-be-before-end_datetime"></a>
</h4>
<p><strong>Problem:</strong> Date range is reversed or invalid.</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correct format: "YYYY-MM-DD HH:MM"</span></span>
<span><span class="va">start_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-01 00:00"</span> <span class="co"># Earlier date</span></span>
<span><span class="va">end_datetime</span> <span class="op">&lt;-</span> <span class="st">"2025-03-31 23:59"</span> <span class="co"># Later date</span></span>
<span></span>
<span><span class="co"># Check your dates before downloading</span></span>
<span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hm</a></span><span class="op">(</span><span class="va">start_datetime</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hm</a></span><span class="op">(</span><span class="va">end_datetime</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="empty-or-no-data-returned">Empty or No Data Returned<a class="anchor" aria-label="anchor" href="#empty-or-no-data-returned"></a>
</h4>
<p><strong>Problem:</strong> Query returns empty tibble.</p>
<p><strong>Possible causes:</strong></p>
<ol style="list-style-type: decimal">
<li>Station has no data for the specified date range</li>
<li>Parameters not measured at this station</li>
<li>Network connectivity issues</li>
<li>API temporarily unavailable</li>
</ol>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check if station exists and is active</span></span>
<span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_stations.html">list_stations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">station_info</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">station_id</span> <span class="op">==</span> <span class="va">your_station_id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try a recent date range (last 7 days)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_air_quality_data.html">download_air_quality_data</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="va">your_station_id</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span>,</span>
<span>  start_datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">7</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span>, <span class="st">"%Y-%m-%d %H:%M"</span><span class="op">)</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y-%m-%d %H:%M"</span><span class="op">)</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"hourly"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check multiple stations to verify API connectivity</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="slow-downloads">Slow Downloads<a class="anchor" aria-label="anchor" href="#slow-downloads"></a>
</h4>
<p><strong>Problem:</strong> Downloads taking too long.</p>
<p><strong>Solutions:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Use parallel processing</span></span>
<span><span class="va">bulk_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>  start_datetime <span class="op">=</span> <span class="st">"2025-03-16 00:00"</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="st">"2025-03-16 12:00"</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Reduce date range</span></span>
<span><span class="co"># Instead of years, download months at a time</span></span>
<span></span>
<span><span class="co"># 3. Use daily instead of hourly frequency</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_air_quality_data.html">download_air_quality_data</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="va">station_id</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span>,</span>
<span>  start_datetime <span class="op">=</span> <span class="st">"2024-01-01 00:00"</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="st">"2024-12-31 23:59"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"daily"</span> <span class="co"># Much smaller dataset</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Download fewer parameters at once</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="package-future-not-found-parallel-processing">“Package ‘future’ not found” (Parallel Processing)<a class="anchor" aria-label="anchor" href="#package-future-not-found-parallel-processing"></a>
</h4>
<p><strong>Problem:</strong> Trying to use parallel processing without required packages.</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"future"</span>, <span class="st">"furrr"</span>, <span class="st">"progressr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/furrr" class="external-link">furrr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="network-timeouts-or-connection-errors">Network Timeouts or Connection Errors<a class="anchor" aria-label="anchor" href="#network-timeouts-or-connection-errors"></a>
</h4>
<p><strong>Problem:</strong> API requests timing out.</p>
<p><strong>Solutions:</strong></p>
<ol style="list-style-type: decimal">
<li>Check internet connection</li>
<li>Try again later (API might be under maintenance)</li>
<li>Reduce number of parallel workers</li>
<li>Use smaller date ranges or fewer parameters</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reduce parallel workers if getting timeouts</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>  start_datetime <span class="op">=</span> <span class="st">"2025-03-16 00:00"</span>,</span>
<span>  end_datetime <span class="op">=</span> <span class="st">"2025-03-16 12:00"</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">2</span> <span class="co"># Reduced from 8</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="memory-errors-in-parallel-mode">Memory Errors in Parallel Mode<a class="anchor" aria-label="anchor" href="#memory-errors-in-parallel-mode"></a>
</h4>
<p><strong>Problem:</strong> Out of memory when using parallel processing.</p>
<p><strong>Solutions:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Reduce number of workers</span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Instead of 8</span></span>
<span></span>
<span><span class="co"># 2. Process in smaller batches</span></span>
<span><span class="co"># 3. Write results to disk immediately (use Parquet/Arrow)</span></span>
<span><span class="co"># 4. Use daily frequency instead of hourly</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="progress-bar-not-showing">Progress Bar Not Showing<a class="anchor" aria-label="anchor" href="#progress-bar-not-showing"></a>
</h4>
<p><strong>Problem:</strong> No progress indication during downloads.</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For sequential downloads, ensure cli is installed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"cli"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For parallel downloads, use progressr</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"progressr"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org" class="external-link">progressr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/handlers.html" class="external-link">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/handlers.html" class="external-link">handlers</a></span><span class="op">(</span><span class="st">"progress"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bulk_download_air_quality_data.html">bulk_download_air_quality_data</a></span><span class="op">(</span></span>
<span>    start_datetime <span class="op">=</span> <span class="st">"2025-03-16 00:00"</span>,</span>
<span>    end_datetime <span class="op">=</span> <span class="st">"2025-03-16 12:00"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span><span class="op">)</span>,</span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    workers <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="getting-more-help">Getting More Help<a class="anchor" aria-label="anchor" href="#getting-more-help"></a>
</h3>
<p>If you’re still experiencing issues:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Check function documentation</strong>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">download_air_quality_data</span></span>
<span><span class="op">?</span><span class="va">bulk_download_air_quality_data</span></span>
<span><span class="op">?</span><span class="va">list_stations</span></span></code></pre></div>
</li>
<li>
<p><strong>Review vignettes</strong> for detailed examples:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"getting-started"</span>, package <span class="op">=</span> <span class="st">"airqualitytr"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Report bugs</strong>: <a href="https://github.com/emraher/airqualitytr/issues" class="external-link uri">https://github.com/emraher/airqualitytr/issues</a></p>
<ul>
<li>Include your R version: <code>R.version.string</code>
</li>
<li>Include package version: <code>packageVersion("airqualitytr")</code>
</li>
<li>Provide a minimal reproducible example</li>
<li>Include any error messages</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="data-source-and-citation">Data Source and Citation<a class="anchor" aria-label="anchor" href="#data-source-and-citation"></a>
</h2>
<div class="section level3">
<h3 id="data-source">Data Source<a class="anchor" aria-label="anchor" href="#data-source"></a>
</h3>
<p>This package accesses air quality monitoring data from the <strong>Turkish Ministry of Environment, Urbanization and Climate Change</strong> (Çevre, Şehircilik ve İklim Değişikliği Bakanlığı).</p>
<p><strong>Official Data Portal:</strong> <a href="https://sim.csb.gov.tr/" class="external-link uri">https://sim.csb.gov.tr/</a></p>
</div>
<div class="section level3">
<h3 id="licensing-and-usage">Licensing and Usage<a class="anchor" aria-label="anchor" href="#licensing-and-usage"></a>
</h3>
<p><strong>Important:</strong> Before using this data in research or publications, please:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Check the official data policy</strong> at the Ministry’s website for:
<ul>
<li>Data licensing terms</li>
<li>Citation requirements</li>
<li>Usage restrictions and permissions</li>
<li>Redistribution rights</li>
</ul>
</li>
<li>
<strong>Cite appropriately</strong> in your work:
<ul>
<li>Cite the data source (Turkish Ministry of Environment)</li>
<li>Cite this R package if used for data access</li>
<li>Follow any specific citation requirements from the Ministry</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="suggested-citation-format">Suggested Citation Format<a class="anchor" aria-label="anchor" href="#suggested-citation-format"></a>
</h3>
<p><strong>For the data:</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>Turkish Ministry of Environment, Urbanization and Climate <span class="fu">Change.</span> (Year).</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>Air Quality Monitoring Data. Retrieved from https<span class="sc">:</span><span class="er">//</span>sim.csb.gov.tr<span class="sc">/</span></span></code></pre></div>
<p><strong>For this package:</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"airqualitytr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-quality-and-limitations">Data Quality and Limitations<a class="anchor" aria-label="anchor" href="#data-quality-and-limitations"></a>
</h3>
<p>Please note:</p>
<ul>
<li>Data is provided as-is from the Ministry’s monitoring network</li>
<li>This package does not validate or quality-control the data</li>
<li>Users are responsible for their own data quality checks</li>
<li>Station metadata and availability may change over time</li>
<li>Historical data availability varies by station</li>
<li>Some stations may have gaps or missing measurements</li>
</ul>
<p><strong>Always perform your own data quality assessment before analysis.</strong></p>
</div>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the airqualitytr project is released with a <a href="https://eremrah.com/airqualitytr/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/emraher/airqualitytr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/emraher/airqualitytr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing airqualitytr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Emrah Er <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9909-7479" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=airqualitytr" class="external-link"><img src="https://www.r-pkg.org/badges/version/airqualitytr" alt="CRAN status"></a></li>
<li><a href="https://github.com/emraher/airqualitytr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/emraher/airqualitytr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emrah Er.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
